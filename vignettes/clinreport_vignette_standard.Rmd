---
title: "ClinReport Vignette 1: Clinical Standards for Reporting Statistics"
author: "Jean-Francois COLLIN"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{ClinReport Vignette 1: Clinical Standards for Reporting Statistics}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Clinical Standards

There is no official guidance regarding the format of the statistic tables used in a clinical trial report,
but there are some implicit standards that are 'accepted/recognized' and most frequently used.

Those standards are given below in no specific order:

>
*	If statistics are reported by treatment group, display the statistics by treatment groups in columns
*	Do not display horizontal or vertical lines in the body of the table 
*	When there are statistics reported for several parameters or if they are reported by level of another factor
in the same table, split the results by parameter with a space
*	Add the number of subject randomized in the column headers 
*	Each output should be numbered
*	Each output should have a title
*	The number of digits should be the same in all cells 
*	Always display the unit of the measured parameter in its label between parenthesis
*	Police Headers should be bolded
*	Usually for baseline characteristics add the Total column along with the treatment groups
*	Use (most of the time) the Times police


For quantitative statistics:

>
*	Report systematically the standard deviation between parenthesis after the mean *mean(SD)*
*	Report the interval Q1 Q3 between brackets: *[Q1;Q3]*
*	Report the interval Min Max between brackets: *[Min;Max]*


For qualitative statistics:

>
*	Report the percentages and the number of observations *N(%)* or *%(N)*


For Least-Square Means statistics and P-values:

>
*	Report systematically the standard error between parenthesis after the estimate *estimate(SE)*
*	Report the 95% interval between brackets: *[Lower Bound;Upper Bound]*
*	Display *P<0.001* instead of the value

Those few rules are the default reporting option in the package **ClinReport**
as can be seen in the table below:

```{r, echo = TRUE, message=FALSE, warning=FALSE, include=FALSE}
library(officer)
library(flextable)
library(dplyr)
library(reshape2)
library(nlme)
library(emmeans)
library(car)
	
```  


```{r, include=TRUE}
library(ClinReport)

data(data)

# Default quantitative stat desc

tab1=report.quanti(data=data,y="y_numeric",
		x1="GROUP",y.label="Quantitative response (units)",
		subjid="SUBJID",total=T)
		
# Default qualitative stat desc

tab2=report.quali(data=data,y="y_logistic",
		x1="GROUP",y.label="Qualitative response",
		subjid="SUBJID",total=T)

# Binding them into a single table

tab=regroup(tab1,tab2)

# Create formatted output for Microsoft Word

doc=report.doc(tab,title="Table of classic descriptive statistics (qualitative and quantitative parameter)",
		colspan.value="Treatment group", init.numbering =T )			

doc
```


It's the only purpose of the package **ClinReport**: make Clincal Reporting easy


















